<%= render 'layouts/application' %>
<div class="innerpage_banner">
	<!-- <img src="img/staff.png"> -->
	 <%= image_tag("staff.png" , :alt => 'staff.png') %>
	<div class="container">
		<div class="row">
			<div class="banner-innerpage">
				<h2>Be<span>St</span>aff</h2>
			</div>
		</div>
	</div>
	
	</div><!-- end .innerpage_banner -->
	</div><!-- end. header -->
	<div class="content inner-page">
		<div class="container">
			<div class="row">
				
				
				<div class="col-lg-7">
					<form class="form-horizontal add-employee search-employee" role="form" action="/search">
						<!--div class="form-group">
							<label class="control-label col-sm-3" for="">Dates</label>
							<div class="col-sm-3">
								<input type="email" class="form-control" id="email" placeholder="11-6-2015">
							</div><div class="col-sm-3">
							<input type="email" class="form-control" id="email" placeholder="28-6-2015">
						</div><div class="col-sm-3">
						<!-- <input type="email" class="form-control" id="email" placeholder=""> -->
						<!--select>
							<option value="">Select Years</option>
							<option value="">Less than 5 years</option>
							<option selected="">More than 5 years</option>
							
						</select>
					</div>
				</div-->
				<div class="form-group">
					<label class="control-label col-sm-3" for="pwd">Skill</label>
					<div class="col-sm-9">
						<input type="text" name="skills" class="form-control autoComplete" id="pwd" placeholder="" value="<%= params[:skills] %>">
					</div>
				</div>
				<div class="form-group">
					<label class="control-label col-sm-3" for="pwd">Experience</label>
					<div class="col-sm-9">
						<input type="text" name="experience" class="form-control" id="pwd" placeholder="" value="<%= params[:experience] %>">
					</div>
				</div>
				<div class="form-group">
					<label class="control-label col-sm-3" for="pwd">Qualification</label>
					<div class="col-sm-9">
						<input type="text" name="staff_quf" class="form-control" id="pwd" placeholder="" value="<%= params[:staff_quf] %>">
					</div>
				</div>
				<div class="form-group">
					<label class="control-label col-sm-3" for="pwd">Availability</label>
					<div class="col-sm-9">
						<input type="text" name="availability" class="form-control" id="pwd" placeholder="" value="<%= params[:availability] %>">
					</div>
				</div>
				<!--div class="form-group">
					<label class="control-label col-sm-3" for="pwd">Price level</label>
					<div class="col-sm-9">
						
						<% #image_tag("rang.png" , :alt => 'rang.png') %>
					</div>
				</div-->
				
				<div class="form-group">
					<div class="col-sm-offset-2 col-sm-10 ">
						<button type="submit" class="btn btn-default  pull-right">Search Staff</button>
					</div>
				</div>
			</form>
		</div>
		<div class="col-lg-5 map">
			<!-- <img src="img/map.png"> -->
			<%= image_tag("map.png" , :alt => 'map.png') %>
		</div>
		
		
	</div>
<div class="row">
  	 <% if current_user %>
		<%= form_tag '/favourite_searches' do %>
			<%= hidden_field_tag 'skills', @search_results.first.skills %>
			<%= hidden_field_tag 'qualification', @search_results.first.qualification %>
			<%= hidden_field_tag 'experience', @search_results.first.experience %>
			<%= hidden_field_tag 'availability', @search_results.first.availability %>
			<%= hidden_field_tag 'user_id', current_user.id %>
			<%= submit_tag "Save Search Result", :class => 'btn btn-default' %>
		<% end %>
	<% end %> 
</div>

	<div class="row">
		

		<% @search_results.each do |data| %> 
			<div class="col-lg-4 col-sm-4 search-result">
				<!-- <img src="img/search1.jpg"> -->
				<%= image_tag("search1.jpg" , :alt => 'search1.jpg') %>
				<div class="company-search">
					<span><%= image_tag(data.image.url , :alt => 'company1.png') %></span>
					<a href="/staff_details/<%= data.id%>">View More</a>
				</div>
				<span class="rate-search">6,300 <sup>kr</sup></span>
				<h5><%= data.company_fn %> <%= data.company_ln %>/ <%= data.first_name %> <%= data.last_name %></h5>
			</div>
		<% end %>  


	</div>
	
</div>

</div>
     <% finalArr = []  %>
      <% @skills.each do |skill| %>
          <% @singlearr =  skill.split(",") %>
            <% @singlearr.each do |arr|  %>
              <% finalArr.push(arr) %>
            <% end %>
        <% end %>
        <%#=debug finalArr %>
        <input type="hidden" id="hiddenComplete" value="<%= finalArr %>"> 
  <script type="text/javascript">

    $(document).ready(function () {
      var autCompleteArr = [];
      var autoCompleteData = $('#hiddenComplete').val();
      if(autoCompleteData && autoCompleteData !='') {
        
        var newArr = autoCompleteData.split(',');
       $.each(newArr, function (index, value) {
        var newValue = value.replace(/[^a-z0-9\s]/gi, '');
        autCompleteArr.push(newValue);
       });

        var unique=autCompleteArr.filter(function(itm,i,a){
          return i==autCompleteArr.indexOf(itm);
      });
        //console.log('Here ', unique);
       $( "#skilsComplete" ).autocomplete({
        source: unique
       });
       $(".autoComplete").autocomplete({
        source: unique
       });
      }

    });
    </script>
<%= render 'layouts/footer' %>